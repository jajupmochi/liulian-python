---
# Adaptation Plan Template
# Generated by project-adaptor skill

run_id: "{{ run_id }}"
timestamp: "{{ timestamp }}"
target_project: "{{ target_project.path }}"
reference_projects:
{% for ref in reference_projects %}
  - id: "C_r{{ loop.index }}"
    path: "{{ ref.path }}"
    source: "{{ ref.source }}"
{% if ref.timestamp %}
    timestamp: "{{ ref.timestamp }}"
{% endif %}
{% endfor %}

items:
{% for item in selected_items %}
  - name: "{{ item.name }}"
    type: "{{ item.type }}"
    source_project: "{{ item.source_project_id }}"
    estimated_steps: {{ item.estimated_steps }}
    risk_level: "{{ item.risk_level }}"
{% endfor %}

configuration:
  dry_run: {{ config.dry_run }}
  mode: "{{ config.mode }}"
  batch_size: {{ config.batch_size }}
  auto_test: {{ config.auto_test }}
  create_branch: {{ config.create_branch }}
  token_budget: {{ config.token_budget }}
  copilot_premium_request_budget: {{ config.copilot_premium_request_budget }}

feature_branch: "feat/adapt-{{ run_id }}"

substeps:
{% for item in selected_items %}
  # {{ item.name }}
{% for substep in item.substeps %}
  - step_id: "{{ substep.id }}"
    description: "{{ substep.description }}"
    estimated_loc: {{ substep.estimated_loc }}
    files_affected: {{ substep.files_affected }}
    change_type: "{{ substep.change_type }}"  # create, modify, delete
{% endfor %}
{% endfor %}

conflicts_to_resolve:
{% for conflict in conflicts %}
  - conflict_id: {{ conflict.id }}
    severity: "{{ conflict.severity }}"
    type: "{{ conflict.type }}"
    resolution_required: {% if conflict.severity in ['CRITICAL', 'HIGH'] %}true{% else %}false{% endif %}
{% endfor %}
